<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Une Dernière Danse</title>
    <style>
        /* General Body and Layout */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center; /* Center the content vertically */
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
            position: relative;
            overflow: hidden;
            flex-direction: column; /* Stack content vertically */
        }

        /* Header Styling */
        h1 {
            font-size: 5em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 5px;
            text-shadow: 4px 4px 10px rgba(255, 255, 255, 0.2), 
                         0 0 25px rgba(255, 255, 255, 0.4), 
                         0 0 50px rgba(255, 255, 255, 0.5);
            animation: fadeIn 3s ease-in-out;
            margin-bottom: 20px; /* Add space between header and content */
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Hidden Class for Text */
        .hidden {
            opacity: 0;
        }

        /* Fade-in Effect for Text */
        .fade-in {
            animation: fadeIn 2s forwards;
        }

        /* Button Styles */
        button {
            background: linear-gradient(145deg, #6e7a90, #434f64);
            color: white;
            font-size: 1.2em;
            padding: 18px 40px;
            margin: 20px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            display: none; /* Buttons are hidden by default */
        }

        /* Hover and Focus Effects for Buttons */
        button:hover {
            background: linear-gradient(145deg, #434f64, #6e7a90);
            box-shadow: 4px 4px 15px rgba(0, 0, 0, 0.3);
            transform: translateY(-3px);
        }

        button:focus {
            outline: none;
            transform: translateY(-3px);
        }

        /* Floating Hearts */
        .hearts {
            position: absolute;
            font-size: 30px;
            color: red;
            animation: floatHearts 3s infinite;
            z-index: 999;
        }

        @keyframes floatHearts {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            50% {
                transform: translateY(-50px);
                opacity: 0.5;
            }
            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Fade-out Animation for Page */
        .fade-out {
            animation: fadeOut 3s forwards;
        }

        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Confirmation and Bye Messages */
        .message {
            font-size: 2em;
            font-weight: bold;
            margin-top: 30px;
        }

        .bye-message {
            font-size: 2em;
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div>
        <h1>THE LAST DANCE ?</h1>
    </div>

    <div id="content">
        <div id="message">
            <p class="hidden">A last dance.</p>
            <p class="hidden">A place where memories remain.</p>
            <p class="hidden">Where silence speaks to us.</p>
            <p class="hidden">If you've made it this far, then you know the rest.</p>
            <p class="hidden">I am in Ris Orangis.</p>
            <p class="hidden">If your heart feels like it, join me at 8:30 PM.</p>
            <p class="hidden">Otherwise, let this last dance float in our memories.</p>
        </div>

        <br>

        <button id="btnOui">Yes, I am coming</button>
        <button id="btnNon">No, I am not</button>
    </div>

    <script>
        // Display text line by line and show buttons after all text is displayed
        window.onload = function() {
            const lines = document.querySelectorAll("#message p");
            let delay = 800; // Initial delay before first text

            lines.forEach((line, index) => {
                setTimeout(() => {
                    line.classList.remove("hidden");
                    line.classList.add("fade-in");
                }, delay);
                delay += 1500; // Delay of 1.5 seconds between each line
            });

            // Show buttons after all text has been displayed
            setTimeout(() => {
                document.getElementById("btnOui").style.display = "inline-block";
                document.getElementById("btnNon").style.display = "inline-block";
            }, delay);
        };

        // Button click handling
        document.getElementById("btnOui").onclick = function() {
            sendMessage("Oui, je viens");
            changeAnimation(true);
        };

        document.getElementById("btnNon").onclick = function() {
            sendMessage("Non, je reste");
            changeAnimation(false);
        };

        function sendMessage(response) {
            console.log(response);
            fetch('/send-message', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ message: response })
            })
            .then(response => response.json())
            .then(data => {
                alert("Message envoyé !");
                console.log("data:", data);
            })
            .catch(error => {
                alert("Erreur lors de l'envoi du message.");
                console.error("Error:", error);
            });
        }

        // Function to change animation and colors based on the user's choice
        function changeAnimation(isYes) {
            const content = document.getElementById("content");
            const message = document.createElement("div");

            // Hide buttons when clicked
            document.getElementById("btnOui").style.display = "none";
            document.getElementById("btnNon").style.display = "none";

            // Fade out initial content
            const initialMessage = document.getElementById("message");
            initialMessage.classList.add("fade-out");

            setTimeout(() => {
                initialMessage.style.display = "none"; // Hide initial text after animation
            }, 2000);

            if (isYes) {
                // If the user clicks "Yes, I am coming"
                document.body.style.backgroundColor = "#ff4d6d";  // Red / Pink
                document.body.style.color = "white";

                // Show floating hearts
                for (let i = 0; i < 10; i++) {
                    const heart = document.createElement("div");
                    heart.classList.add("hearts");
                    heart.style.left = `${Math.random() * 100}vw`;
                    heart.style.top = `${Math.random() * 100}vh`;
                    heart.innerHTML = "❤️";
                    document.body.appendChild(heart);
                }

                // Show the "À tout de suite ma Linguère" message
                message.classList.add("message");
                message.innerHTML = "À tout de suite ma Linguère";
                content.appendChild(message);

                // Fade out the page after a few seconds
                setTimeout(() => {
                    document.body.classList.add("fade-out");
                }, 5000);
            } else {
                // If the user clicks "No, I am staying"
                document.body.style.backgroundColor = "#3e3e3e";  // Dark gray
                document.body.style.color = "#bbb";  // Faded text

                // Show the "BYE" message
                message.classList.add("bye-message");
                message.innerHTML = "BYE";
                content.appendChild(message);

                // Fade out the page immediately
                setTimeout(() => {
                    document.body.classList.add("fade-out");
                }, 1000);
            }
        }
    </script>
</body>
</html>
